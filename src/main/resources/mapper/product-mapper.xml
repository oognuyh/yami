<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ProductMapper">
    <resultMap id="productMap" type="Product">
        <result column="product_id" property="productId" />
        <result column="category_id" property="categoryId" />
        <result column="category_name" property="categoryName" />
        <result column="name" property="name" />
        <result column="image_url" property="imageUrl" />
        <result column="summary" property="summary" />
        <result column="created_at" property="createdAt" />
        <result column="updated_at" property="updatedAt" />
        <collection property="content" ofType="imageMap" select="ImageMapper.findImages" column="targetId=product_id" />
    </resultMap>

    <select id="findProducts" resultMap="productMap">
        SELECT p.*, c.name AS category_name
        FROM products p
        JOIN categories c
        ON p.category_id = c.category_id
    </select>
    
    <select id="OrderItems"  parameterType="string" resultType="org.yami.order.dto.OrderItem">
    	SELECT oi.*, p.name AS product_name, p.price AS product_price, p.image_url AS product_image_url 
    	FROM orderitems oi
    	JOIN products p
    	ON oi.product_id=p.product_id
    	WHERE user_id = #{userId}
    </select>
    
    <!-- 주문자 기본정보 출력 -->
    <select id="getUserData">
    	SELECT name, email
    	FROM users
    	WHERE user_id=#{user_id}
    </select>
    
    
    
    
</mapper>